"use strict";(self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[]).push([[936],{8936:function(t,s,a){a.r(s),a.d(s,{default:function(){return h}});var e=function(){var t=this,s=t._self._c;return s("div",{staticClass:"container"},[s("nav-bar",{attrs:{title:"会员登录"}}),s("div",{staticClass:"main"},[s("div",{staticClass:"title"},[t._v("手机号登录")]),s("div",{staticClass:"subtitle"},[t._v("未注册的手机号登录后将自动注册")]),s("div",{staticClass:"form"},[s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.mobile,expression:"mobile"}],staticClass:"input",attrs:{type:"text",placeholder:"请输入手机号码"},domProps:{value:t.mobile},on:{input:function(s){s.target.composing||(t.mobile=s.target.value)}}})]),s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.captchaCode,expression:"captchaCode"}],staticClass:"input",attrs:{type:"text",placeholder:"请输入图形验证码"},domProps:{value:t.captchaCode},on:{input:function(s){s.target.composing||(t.captchaCode=s.target.value)}}}),s("div",{staticClass:"code",on:{click:t.clickCaptcha}},[t.captchaInfo.captchaImg?s("img",{attrs:{src:t.captchaInfo.captchaImg,alt:""}}):t._e()])]),s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.smsCode,expression:"smsCode"}],staticClass:"input",attrs:{type:"text",placeholder:"请输入短信验证码"},domProps:{value:t.smsCode},on:{input:function(s){s.target.composing||(t.smsCode=s.target.value)}}}),t.second!=t.totalSecond?s("button",{staticClass:"btn btn1"},[t._v("重新发送("+t._s(t.second)+")秒")]):s("button",{staticClass:"btn btn2",on:{click:t.getSmsCaptcha}},[t._v("获取验证码")])]),s("button",{staticClass:"btn",on:{click:t.login}},[t._v("登录")])])])],1)},i=[],o={name:"LoginIndex",data(){return{mobile:"",captchaCode:"",smsCode:"",captchaInfo:{},totalSecond:60,second:60,timer:null}},created(){this.getCaptchaImage()},methods:{async getCaptchaImage(){const{data:{base64:t,key:s}}=await this.$api.login.getCaptchaImage();this.captchaInfo={captchaImg:t,captchaKey:s}},clickCaptcha(){this.getCaptchaImage()},validFn(){const t=/^1[3-9]\d{9}$/,s=/^\w{4}$/;return this.mobile?t.test(this.mobile)?this.captchaCode?!!s.test(this.captchaCode)||(this.$toast("请输入四位验证码"),!1):(this.$toast("请输入图形验证码"),!1):(this.$toast("请输入正确的手机号"),!1):(this.$toast("请输入手机号"),!1)},countDown(){this.second--,this.timer=setInterval((()=>{this.second--,0===this.second&&(clearTimeout(this.timer),this.timer=null,this.second=this.totalSecond)}),1e3)},async getSmsCaptcha(){this.validFn()&&(await this.$api.login.getSmsCaptcha(this.captchaCode,this.captchaInfo.captchaKey,this.mobile),this.$toast.success("短信发送成功"),this.countDown())},async login(){const t=/^\w{6}$/;if(!this.validFn())return;if(!this.smsCode)return void this.$toast("请输入短信验证码");if(!t.test(this.smsCode))return void this.$toast("请输入六位短信验证码");const{message:s,data:a}=await this.$api.login.login(this.mobile,this.smsCode);this.$store.commit("user/setUserInfo",a),this.$toast.success(s);const e=this.$route.query.backUrl||"/";this.$router.replace(e)}},destroyed(){clearTimeout(this.timer)}},c=o,n=a(3736),l=(0,n.Z)(c,e,i,!1,null,"2ba8ddd7",null),h=l.exports}}]);
//# sourceMappingURL=936.556776e3.js.map