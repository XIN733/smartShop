{"version":3,"file":"js/936.556776e3.js","mappings":"kKAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,UAAU,CAACG,MAAM,CAAC,MAAQ,UAAUH,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,MAAM,CAACE,YAAY,SAAS,CAACJ,EAAIM,GAAG,WAAWJ,EAAG,MAAM,CAACE,YAAY,YAAY,CAACJ,EAAIM,GAAG,qBAAqBJ,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,QAAQ,CAACK,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOV,EAAIW,OAAQC,WAAW,WAAWR,YAAY,QAAQC,MAAM,CAAC,KAAO,OAAO,YAAc,WAAWQ,SAAS,CAAC,MAASb,EAAIW,QAASG,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOC,OAAOC,YAAiBjB,EAAIW,OAAOI,EAAOC,OAAON,MAAK,OAAOR,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,QAAQ,CAACK,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOV,EAAIkB,YAAaN,WAAW,gBAAgBR,YAAY,QAAQC,MAAM,CAAC,KAAO,OAAO,YAAc,YAAYQ,SAAS,CAAC,MAASb,EAAIkB,aAAcJ,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOC,OAAOC,YAAiBjB,EAAIkB,YAAYH,EAAOC,OAAON,MAAK,KAAKR,EAAG,MAAM,CAACE,YAAY,OAAOU,GAAG,CAAC,MAAQd,EAAImB,eAAe,CAAEnB,EAAIoB,YAAYC,WAAYnB,EAAG,MAAM,CAACG,MAAM,CAAC,IAAML,EAAIoB,YAAYC,WAAW,IAAM,MAAMrB,EAAIsB,SAASpB,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,QAAQ,CAACK,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOV,EAAIuB,QAASX,WAAW,YAAYR,YAAY,QAAQC,MAAM,CAAC,KAAO,OAAO,YAAc,YAAYQ,SAAS,CAAC,MAASb,EAAIuB,SAAUT,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOC,OAAOC,YAAiBjB,EAAIuB,QAAQR,EAAOC,OAAON,MAAK,KAAMV,EAAIwB,QAAQxB,EAAIyB,YAAavB,EAAG,SAAS,CAACE,YAAY,YAAY,CAACJ,EAAIM,GAAG,QAAQN,EAAI0B,GAAG1B,EAAIwB,QAAQ,QAAQtB,EAAG,SAAS,CAACE,YAAY,WAAWU,GAAG,CAAC,MAAQd,EAAI2B,gBAAgB,CAAC3B,EAAIM,GAAG,aAAaJ,EAAG,SAAS,CAACE,YAAY,MAAMU,GAAG,CAAC,MAAQd,EAAI4B,QAAQ,CAAC5B,EAAIM,GAAG,aAAa,EAC5uD,EACIuB,EAAkB,GC0BtB,GACArB,KAAA,aACAsB,IAAAA,GACA,OACAnB,OAAA,GACAO,YAAA,GACAK,QAAA,GACAH,YAAA,GACAK,YAAA,GACAD,OAAA,GACAO,MAAA,KAEA,EACAC,OAAAA,GACA,KAAAC,iBACA,EACAC,QAAA,CACA,qBAAAD,GACA,MAAAH,MAAA,OAAAK,EAAA,IAAAC,UAAA,KAAAC,KAAAT,MAAAK,kBACA,KAAAb,YAAA,CACAC,WAAAc,EACAG,WAAAF,EAEA,EACAjB,YAAAA,GACA,KAAAc,iBACA,EAEAM,OAAAA,GACA,MAAAC,EAAA,gBACAC,EAAA,UACA,YAAA9B,OAIA6B,EAAAE,KAAA,KAAA/B,QAIA,KAAAO,cAIAuB,EAAAC,KAAA,KAAAxB,eACA,KAAAyB,OAAA,aACA,IALA,KAAAA,OAAA,aACA,IALA,KAAAA,OAAA,cACA,IALA,KAAAA,OAAA,WACA,EAeA,EAEAC,SAAAA,GACA,KAAApB,SACA,KAAAO,MAAAc,aAAA,KACA,KAAArB,SACA,SAAAA,SACAsB,aAAA,KAAAf,OACA,KAAAA,MAAA,KACA,KAAAP,OAAA,KAAAC,YACA,GACA,IACA,EACA,mBAAAE,GACA,KAAAY,kBAGA,KAAAF,KAAAT,MAAAD,cAAA,KAAAT,YAAA,KAAAE,YAAAkB,WAAA,KAAA3B,QACA,KAAAgC,OAAAI,QAAA,UACA,KAAAH,YACA,EACA,WAAAhB,GACA,MAAAa,EAAA,UACA,SAAAF,UACA,OAEA,SAAAhB,QAEA,YADA,KAAAoB,OAAA,YAGA,IAAAF,EAAAC,KAAA,KAAAnB,SAEA,YADA,KAAAoB,OAAA,cAGA,cAAAK,EAAA,KAAAlB,SAAA,KAAAO,KAAAT,MAAAA,MAAA,KAAAjB,OAAA,KAAAY,SACA,KAAA0B,OAAAC,OAAA,mBAAApB,GACA,KAAAa,OAAAI,QAAAC,GAEA,MAAAG,EAAA,KAAAC,OAAAC,MAAAC,SAAA,IACA,KAAAC,QAAAC,QAAAL,EACA,GAEAM,SAAAA,GACAX,aAAA,KAAAf,MACA,GCxH2R,I,UCQvR2B,GAAY,OACd,EACA3D,EACA8B,GACA,EACA,KACA,WACA,MAIF,EAAe6B,EAAiB,O","sources":["webpack://vue-project/./src/views/login/index.vue","webpack://vue-project/src/views/login/index.vue","webpack://vue-project/./src/views/login/index.vue?4c9f","webpack://vue-project/./src/views/login/index.vue?4d0b"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"container\"},[_c('nav-bar',{attrs:{\"title\":\"会员登录\"}}),_c('div',{staticClass:\"main\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"手机号登录\")]),_c('div',{staticClass:\"subtitle\"},[_vm._v(\"未注册的手机号登录后将自动注册\")]),_c('div',{staticClass:\"form\"},[_c('div',{staticClass:\"input-box\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.mobile),expression:\"mobile\"}],staticClass:\"input\",attrs:{\"type\":\"text\",\"placeholder\":\"请输入手机号码\"},domProps:{\"value\":(_vm.mobile)},on:{\"input\":function($event){if($event.target.composing)return;_vm.mobile=$event.target.value}}})]),_c('div',{staticClass:\"input-box\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.captchaCode),expression:\"captchaCode\"}],staticClass:\"input\",attrs:{\"type\":\"text\",\"placeholder\":\"请输入图形验证码\"},domProps:{\"value\":(_vm.captchaCode)},on:{\"input\":function($event){if($event.target.composing)return;_vm.captchaCode=$event.target.value}}}),_c('div',{staticClass:\"code\",on:{\"click\":_vm.clickCaptcha}},[(_vm.captchaInfo.captchaImg)?_c('img',{attrs:{\"src\":_vm.captchaInfo.captchaImg,\"alt\":\"\"}}):_vm._e()])]),_c('div',{staticClass:\"input-box\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.smsCode),expression:\"smsCode\"}],staticClass:\"input\",attrs:{\"type\":\"text\",\"placeholder\":\"请输入短信验证码\"},domProps:{\"value\":(_vm.smsCode)},on:{\"input\":function($event){if($event.target.composing)return;_vm.smsCode=$event.target.value}}}),(_vm.second!=_vm.totalSecond)?_c('button',{staticClass:\"btn btn1\"},[_vm._v(\"重新发送(\"+_vm._s(_vm.second)+\")秒\")]):_c('button',{staticClass:\"btn btn2\",on:{\"click\":_vm.getSmsCaptcha}},[_vm._v(\"获取验证码\")])]),_c('button',{staticClass:\"btn\",on:{\"click\":_vm.login}},[_vm._v(\"登录\")])])])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container\">\r\n    <nav-bar title=\"会员登录\"></nav-bar>\r\n    <div class=\"main\">\r\n      <div class=\"title\">手机号登录</div>\r\n      <div class=\"subtitle\">未注册的手机号登录后将自动注册</div>\r\n      <div class=\"form\">\r\n        <div class=\"input-box\">\r\n          <input type=\"text\" placeholder=\"请输入手机号码\" v-model=\"mobile\" class=\"input\">\r\n        </div>\r\n        <div class=\"input-box\">\r\n          <input type=\"text\" placeholder=\"请输入图形验证码\" v-model=\"captchaCode\" class=\"input\">\r\n          <div class=\"code\" @click=\"clickCaptcha\">\r\n            <img v-if=\"captchaInfo.captchaImg\" :src=\"captchaInfo.captchaImg\" alt=\"\">\r\n          </div>\r\n        </div>\r\n        <div class=\"input-box\">\r\n          <input type=\"text\" placeholder=\"请输入短信验证码\" v-model=\"smsCode\" class=\"input\">\r\n          <button class=\"btn btn1\" v-if=\"second!=totalSecond\">重新发送({{ second }})秒</button>\r\n          <button class=\"btn btn2\" @click=\"getSmsCaptcha\" v-else>获取验证码</button>\r\n        </div>\r\n        <button class=\"btn\" @click=\"login\">登录</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'LoginIndex',\r\n  data () {\r\n    return {\r\n      mobile: '',\r\n      captchaCode: '',\r\n      smsCode: '',\r\n      captchaInfo: {},\r\n      totalSecond: 60,\r\n      second: 60,\r\n      timer: null\r\n    }\r\n  },\r\n  created () {\r\n    this.getCaptchaImage()\r\n  },\r\n  methods: {\r\n    async getCaptchaImage () {\r\n      const { data: { base64, key } } = await this.$api.login.getCaptchaImage()\r\n      this.captchaInfo = {\r\n        captchaImg: base64,\r\n        captchaKey: key\r\n      }\r\n    },\r\n    clickCaptcha () {\r\n      this.getCaptchaImage()\r\n    },\r\n    // 校验\r\n    validFn () {\r\n      const regMobile = /^1[3-9]\\d{9}$/\r\n      const regCode = /^\\w{4}$/\r\n      if (!this.mobile) {\r\n        this.$toast('请输入手机号')\r\n        return false\r\n      }\r\n      if (!regMobile.test(this.mobile)) {\r\n        this.$toast('请输入正确的手机号')\r\n        return false\r\n      }\r\n      if (!this.captchaCode) {\r\n        this.$toast('请输入图形验证码')\r\n        return false\r\n      }\r\n      if (!regCode.test(this.captchaCode)) {\r\n        this.$toast('请输入四位验证码')\r\n        return false\r\n      }\r\n      return true\r\n    },\r\n    // 倒计时\r\n    countDown () {\r\n      this.second--\r\n      this.timer = setInterval(() => {\r\n        this.second--\r\n        if (this.second === 0) {\r\n          clearTimeout(this.timer)\r\n          this.timer = null\r\n          this.second = this.totalSecond\r\n        }\r\n      }, 1000)\r\n    },\r\n    async getSmsCaptcha () {\r\n      if (!this.validFn()) {\r\n        return\r\n      }\r\n      await this.$api.login.getSmsCaptcha(this.captchaCode, this.captchaInfo.captchaKey, this.mobile)\r\n      this.$toast.success('短信发送成功')\r\n      this.countDown()\r\n    },\r\n    async login () {\r\n      const regCode = /^\\w{6}$/\r\n      if (!this.validFn()) {\r\n        return\r\n      }\r\n      if (!this.smsCode) {\r\n        this.$toast('请输入短信验证码')\r\n        return\r\n      }\r\n      if (!regCode.test(this.smsCode)) {\r\n        this.$toast('请输入六位短信验证码')\r\n        return\r\n      }\r\n      const { message, data } = await this.$api.login.login(this.mobile, this.smsCode)\r\n      this.$store.commit('user/setUserInfo', data)\r\n      this.$toast.success(message)\r\n      // 判断是否有携带地址栏\r\n      const url = this.$route.query.backUrl || '/'\r\n      this.$router.replace(url)\r\n    }\r\n  },\r\n  destroyed () {\r\n    clearTimeout(this.timer)\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.container {\r\n  .main {\r\n    padding: 40px 20px 0;\r\n\r\n    .title {\r\n      font-size: 24px;\r\n    }\r\n\r\n    .subtitle {\r\n      font-size: 16px;\r\n      color: #ccc;\r\n      margin: 10px 0 25px;\r\n    }\r\n\r\n    .form {\r\n      .input-box {\r\n        border-bottom: 1px solid #eee;\r\n        display: flex;\r\n        align-items: center;\r\n        margin-bottom: 10px;\r\n\r\n        .input {\r\n          flex: 1;\r\n          font-size: 16px;\r\n          height: 50px;\r\n          padding: 0 5px;\r\n        }\r\n\r\n        .code {\r\n          width: 120px;\r\n          background-color: red;\r\n          display: flex;\r\n\r\n          img {\r\n            width: 100%;\r\n          }\r\n        }\r\n\r\n        .btn {\r\n          width: 120px;\r\n          height: 50px;\r\n          line-height: 50px;\r\n          font-size: 14px;\r\n        }\r\n        .btn1 {\r\n          color: #bbb;\r\n        }\r\n        .btn2 {\r\n          color: orange;\r\n        }\r\n      }\r\n\r\n      >.btn {\r\n        width: 100%;\r\n        height: 45px;\r\n        line-height: 45px;\r\n        background-color: orange;\r\n        font-size: 16px;\r\n        color: #fff;\r\n        border-radius: 30px;\r\n        background-image: linear-gradient(to right, rgb(248, 177, 46), rgb(255, 146, 3));\r\n        margin-top: 20px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=2ba8ddd7&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=2ba8ddd7&prod&lang=less&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2ba8ddd7\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","_v","directives","name","rawName","value","mobile","expression","domProps","on","$event","target","composing","captchaCode","clickCaptcha","captchaInfo","captchaImg","_e","smsCode","second","totalSecond","_s","getSmsCaptcha","login","staticRenderFns","data","timer","created","getCaptchaImage","methods","base64","key","$api","captchaKey","validFn","regMobile","regCode","test","$toast","countDown","setInterval","clearTimeout","success","message","$store","commit","url","$route","query","backUrl","$router","replace","destroyed","component"],"sourceRoot":""}