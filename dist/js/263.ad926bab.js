"use strict";(self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[]).push([[263],{7357:function(t,s,i){i.d(s,{Z:function(){return l}});var e=function(){var t=this,s=t._self._c;return s("div",{staticClass:"coupon-item",on:{click:function(s){return t.couponClick({price:t.coupon.reduce_price,id:t.coupon.user_coupon_id})}}},[s("div",{class:{"coupon-wrapper":!0,"color-gray":t.coupon.is_receive||"已使用"===t.coupon.state.text,"color-blue":t.index%2!==0&&!t.coupon.is_receive&&"已使用"!==t.coupon.state.text}},[s("div",{staticClass:"coupon-type"},[t._v("满减券")]),s("div",{staticClass:"left"},[s("div",{staticClass:"price-box"},[s("span",[t._v("￥")]),s("span",{staticClass:"price"},[t._v(t._s(t.coupon.reduce_price))])]),s("div",{staticClass:"text"},[t._v("满"+t._s(t.coupon.min_price)+"元可用")])]),s("div",{staticClass:"split-line"}),s("div",{staticClass:"right"},[s("div",{staticClass:"top"},[t._v(t._s(t.coupon.name))]),s("div",{staticClass:"bot"},["coupon1"===t.type?s("div",{staticClass:"l"},[t._v("领取"+t._s(t.coupon.expire_day)+"天内有效")]):t._e(),"coupon2"===t.type||"coupon3"===t.type?s("div",{staticClass:"l"},[t._v(t._s(t.coupon.start_time+"~"+t.coupon.end_time))]):t._e(),s("div",{staticClass:"r"},["coupon1"!==t.type||t.coupon.is_receive?t._e():s("button",{staticClass:"btn",on:{click:function(s){return t.receiveCoupon(t.coupon.coupon_id)}}},[t._v("立即领取")]),"coupon1"===t.type&&t.coupon.is_receive?s("div",{staticClass:"text"},[t._v("已领取")]):t._e(),"coupon2"===t.type?s("div",{staticClass:"text"},[t._v(t._s(t.coupon.state.text))]):t._e()])])])])])},o=[],a={props:{coupon:Object,index:Number,type:String},methods:{receiveCoupon(t){this.$emit("receiveCoupon",t)},couponClick(t){this.$emit("couponClick",t)}}},c=a,r=i(3736),n=(0,r.Z)(c,e,o,!1,null,"2553d7a3",null),l=n.exports},5263:function(t,s,i){i.r(s),i.d(s,{default:function(){return d}});i(560);var e=function(){var t=this,s=t._self._c;return s("div",[s("van-nav-bar",{attrs:{title:"订单结算","left-arrow":"",fixed:"","z-index":"100",placeholder:"",border:!1},on:{"click-left":function(s){return t.$router.replace("/cart")}}}),s("div",[s("div",{staticClass:"contact-card",on:{click:function(s){return t.$router.push("/addressList")}}},[t.defaultAddress?s("div",{staticClass:"left"},[s("van-icon",{staticClass:"icon-logistics",attrs:{name:"logistics"}}),s("div",{staticClass:"user-info"},[s("div",{staticClass:"top"},[t._v(t._s(t.defaultAddress.name+" "+t.defaultAddress.phone))]),s("div",{staticClass:"bot line"},[t._v(t._s(t.defaultAddress.region.province+t.defaultAddress.region.city+t.defaultAddress.region.region+t.defaultAddress.detail))])])],1):s("div",{staticClass:"left"},[s("van-icon",{staticClass:"icon-plus",attrs:{name:"plus",size:"20"}}),s("div",{staticClass:"text"},[t._v("选择收货地址")])],1),s("van-icon",{staticClass:"icon-arrow",attrs:{name:"arrow"}})],1),s("div",{staticClass:"content"},[s("div",{staticClass:"goods-list"},[t._l(t.order.goodsList,(function(i){return s("div",{key:i.goods_id,staticClass:"item"},[s("img",{staticClass:"goods-img",attrs:{src:i.goods_image,alt:""}}),s("div",{staticClass:"right"},[s("div",{staticClass:"title line2"},[t._v(t._s(i.goods_name))]),s("div",{staticClass:"bot"},[s("div",{staticClass:"num"},[t._v("x"+t._s(i.total_num))]),s("div",{staticClass:"price"},[t._v("￥"+t._s(i.goods_price_min))])])])])})),s("div",{staticClass:"total"},[t._v("共"+t._s(t.order.orderTotalNum)+"件商品，合计："),s("span",[t._v("￥"+t._s(t.order.orderTotalPrice))])])],2),s("div",{staticClass:"info"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[t._v("订单总金额：")]),s("div",{staticClass:"text"},[s("span",[t._v("￥"+t._s(t.order.orderTotalPrice))])])]),s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[t._v("优惠券：")]),0===t.couponList.length?s("div",{staticClass:"text"},[t._v("无优惠券可用")]):s("div",{staticClass:"link",on:{click:function(s){t.isShowCoupon=!0}}},[0===t.selCoupon.price?s("div",{staticClass:"text"},[t._v("有"+t._s(t.couponList.length)+"张优惠券")]):s("div",{staticClass:"text"},[t._v("-￥"+t._s(t.selCoupon.price))]),s("van-icon",{attrs:{name:"arrow",color:"#999"}})],1)]),t._m(0)]),s("div",{staticClass:"payType"},[s("div",{staticClass:"title"},[t._v("支付方式")]),s("div",{staticClass:"list"},[s("div",{staticClass:"item"},[s("div",{staticClass:"left"},[s("van-icon",{attrs:{name:"balance-o",size:"24"}}),s("div",{staticClass:"text"},[t._v("余额支付（可用￥"+t._s(t.personal.balance)+"元）")])],1),s("van-icon",{attrs:{name:"passed",color:"#EE0A24",size:"22"}})],1)])]),s("div",{staticClass:"remark"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.remark,expression:"remark"}],staticClass:"text",attrs:{placeholder:"选填：买家留言（50字内）",maxlength:"50"},domProps:{value:t.remark},on:{input:function(s){s.target.composing||(t.remark=s.target.value)}}})])]),s("div",{staticClass:"bot-box"},[s("div",{staticClass:"left"},[t._v("实付款："),s("span",[t._v("￥"+t._s(t.orderPayPrice))])]),s("button",{staticClass:"btn",on:{click:t.submit}},[t._v("提交订单")])])]),s("van-action-sheet",{staticClass:"coupon-mask",attrs:{title:"选择优惠券",closeable:!1},model:{value:t.isShowCoupon,callback:function(s){t.isShowCoupon=s},expression:"isShowCoupon"}},[s("div",{staticClass:"content"},[s("div",{staticClass:"coupon-list"},t._l(t.couponList,(function(i,e){return s("coupon-item",{key:i.user_coupon_id,attrs:{coupon:i,index:e,type:"coupon3"},on:{couponClick:t.couponClick}})})),1),s("button",{staticClass:"btn",on:{click:t.noCoupon}},[t._v("不使用优惠券")])])])],1)},o=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[t._v("配送费用：")]),s("div",{staticClass:"text"},[s("span",[t._v("+￥0.00")])])])}],a=i(7357),c={name:"PayIndex",components:{CouponItem:a.Z},data(){return{order:{},personal:{},couponList:[],remark:"",isShowCoupon:!1,selCoupon:{price:0,id:0}}},computed:{defaultAddress(){return this.$store.getters["address/defaultItem"]||""},orderPayPrice(){const t=this.order.orderTotalPrice-this.selCoupon.price;return t.toFixed(2)},mode(){return this.$route.query.mode},obj(){return"cart"===this.mode?{cartIds:this.$route.query.cartIds}:{goodsId:this.$route.query.goodsId,goodsNum:this.$route.query.goodsNum,goodsSkuId:this.$route.query.goodsSkuId}}},created(){this.$store.dispatch("address/getAddressList"),this.getOrderList()},methods:{async getOrderList(){const{data:{order:t,personal:s}}=await this.$api.order.checkOrder(this.mode,this.obj);this.order=t,this.personal=s,this.couponList=t.couponList},async submit(){await this.$api.order.submitOrder(this.mode,this.obj,this.remark,this.selCoupon.id),this.$toast.success("支付成功"),this.$router.replace("/order?dataType=all")},couponClick(t){this.selCoupon=t,this.isShowCoupon=!1},noCoupon(){this.selCoupon={price:0,id:0},this.isShowCoupon=!1}}},r=c,n=i(3736),l=(0,n.Z)(r,e,o,!1,null,"75c9e55f",null),d=l.exports}}]);
//# sourceMappingURL=263.ad926bab.js.map